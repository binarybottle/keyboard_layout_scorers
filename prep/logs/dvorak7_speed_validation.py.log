> poetry run python3 dvorak7_speed_validation.py
Dvorak-7 Criteria Correlation Analysis - Bigram Speed
================================================================================
Configuration:
  Max bigrams: unlimited
  Random seed: 42
  Middle column keys: b, g, h, n, t, y
  Analysis includes both raw and frequency-adjusted correlations
  Using canonical Dvorak-7 scoring from prep_keypair_dvorak7_scores.py

Loading frequency data...
üìÅ Loading frequency data for regression analysis...
   (This uses pre-calculated English language frequencies, NOT sample frequencies)
‚úÖ Loaded bigram frequency data: 669 entries
   Columns: ['letter_pair', 'count', 'normalized_frequency']
   Sample bigram frequencies:
     'th': 1.000000
     'he': 0.931042
     'in': 0.828043
Reading typing data files...
Reading bigram data from ../../process_136M_keystrokes/output/bigram_times.csv...
üìã BIGRAM DATA QUALITY VERIFICATION
   Expected: Correctly typed bigrams from correctly typed words
   Required CSV columns: 'bigram', 'interkey_interval'
   Found columns: ['participant_id', 'sentence_id', 'bigram', 'interkey_interval', 'timestamp1', 'timestamp2']
   Sample bigrams from CSV:
     'th': 137ms
     'he': 72ms
     'ot': 214ms
     'th': 183ms
     'he': 73ms
   Total bigrams in file: 19,809,877
   Quality indicators:
     Common English bigrams in sample: 22/100 (22%)
     Suspicious bigrams (repeated/invalid chars): 3/100 (3%)
   ‚ö†Ô∏è  Low proportion of common English bigrams - check data quality
   ‚úÖ Proceeding with data loading...
Loaded 19,809,877 valid bigrams
üìä FINAL DATA QUALITY SUMMARY:
   Unique bigrams: 413
   Common English bigrams: 3,842,346 (19.4%)
   Average time: 172.2ms ¬± 147.3ms
   ‚úÖ Data quality looks reasonable
Filtered 414,280/19,809,877 bigrams using absolute thresholds (50-2000ms)
  Kept 19,395,597 bigrams (97.9%)
  Time range: 50.0 - 2000.0ms
Creating plots in 'plots/' directory...

================================================================================
STARTING BIGRAM CORRELATION ANALYSIS
================================================================================

BIGRAM ANALYSIS
Splitting 19,395,597 bigrams by middle column key usage...
‚úÖ Bigrams without middle columns: 10,800,898
‚úÖ Bigrams with middle columns: 8,594,699

--- Analyzing Bigrams (No Middle Columns) ---
Group size: 10,800,898 bigrams
‚úÖ ANALYZING Bigrams (No Middle Columns): 10,800,898 bigrams
Examples: er, rs, ra, ai, is
  Raw Analysis:
  Calculating Dvorak-7 scores for 10,800,898 sequences...
      Sample scores for 'er': {'distribution': '0.500', 'strength': '1.000', 'middle': '0.000', 'vspan': '1.000', 'columns': '1.000', 'remote': '1.000', 'inward': '1.000'}
      Sample scores for 'rs': {'distribution': '0.500', 'strength': '0.500', 'middle': '0.500', 'vspan': '0.500', 'columns': '1.000', 'remote': '1.000', 'inward': '0.000'}
      Sample scores for 'ra': {'distribution': '0.500', 'strength': '0.500', 'middle': '0.500', 'vspan': '0.500', 'columns': '1.000', 'remote': '1.000', 'inward': '0.000'}
    Completed score calculation in 50.7s                                                  
    DEBUG STATISTICS:
      Total processed: 10,800,898
      Scoring failures: 0
      Validation failures: 0
      Records added: 10,800,898
      Valid sequences for analysis: 10,800,898
      Sequence scores data length: 10,800,898
    Stored sequence data under key: _sequence_scores_raw_no_middle (10800898 records)
    Calculating correlations for 7 criteria...
    Warning: columns has constant scores (1 unique values)
    Correlation analysis complete
  üîç Starting frequency adjustment for bigrams...
      Input: 10,800,898 sequences, 669 frequency entries
      Frequency data columns: ['letter_pair', 'count', 'normalized_frequency']
      Using 'normalized_frequency' column
      Built frequency dictionary: 669 entries
      Example frequencies: [('th', 1.0), ('he', 0.931042309115242), ('in', 0.82804339705559), ('er', 0.759711617990871), ('an', 0.747899268441765)]
      Frequency overlap: 10800898/10800898 (100.0%)
      Frequency range: 0.000798 to 0.759712 (mean: 0.392049)
      Time range: 50.0 to 2000.0ms (mean: 178.1 ¬± 140.5)
      Regression results:
        R¬≤ = 0.0166
        Slope = -86.5290 (p = 0.0000)
        Intercept = 139.1962
        ‚Üí Negative slope means higher frequency = faster typing
      Frequency control effects:
        Average |residual|: 79.49ms
        Maximum |residual|: 1850.48ms
        Sequences with frequency control: 99.8%
      üìä RANK ORDER ANALYSIS:
        Correlation between raw times and frequency residuals: 0.958655
        Sequences with rank changes: 10800885/10800898 (100.0%)
        Maximum rank position change: 9529900
  ‚úÖ Generated frequency-controlled residuals
  üí° INTERPRETATION: Residuals represent typing speed after controlling for frequency
      ‚Ä¢ Negative residuals = faster than expected given frequency
      ‚Ä¢ Positive residuals = slower than expected given frequency
  Freq Adjusted Analysis:
  Calculating Dvorak-7 scores for 10,800,898 sequences...
      Sample scores for 'er': {'distribution': '0.500', 'strength': '1.000', 'middle': '0.000', 'vspan': '1.000', 'columns': '1.000', 'remote': '1.000', 'inward': '1.000'}
      Sample scores for 'rs': {'distribution': '0.500', 'strength': '0.500', 'middle': '0.500', 'vspan': '0.500', 'columns': '1.000', 'remote': '1.000', 'inward': '0.000'}
      Sample scores for 'ra': {'distribution': '0.500', 'strength': '0.500', 'middle': '0.500', 'vspan': '0.500', 'columns': '1.000', 'remote': '1.000', 'inward': '0.000'}
    Completed score calculation in 51.2s                                                  
    DEBUG STATISTICS:
      Total processed: 10,800,898
      Scoring failures: 0
      Validation failures: 0
      Records added: 10,800,898
      Valid sequences for analysis: 10,800,898
      Sequence scores data length: 10,800,898
    Stored sequence data under key: _sequence_scores_freq_adjusted_no_middle (10800898 records)
    Calculating correlations for 7 criteria...
    Warning: columns has constant scores (1 unique values)
    Correlation analysis complete

--- Analyzing Bigrams (With Middle Columns) ---
Group size: 8,594,699 bigrams
‚úÖ ANALYZING Bigrams (With Middle Columns): 8,594,699 bigrams
Examples: th, he, ot, th, he
  Raw Analysis:
  Calculating Dvorak-7 scores for 8,594,699 sequences...
      Sample scores for 'th': {'distribution': '1.000', 'strength': '1.000', 'middle': '0.500', 'vspan': '1.000', 'columns': '0.000', 'remote': '1.000', 'inward': '1.000'}
      Sample scores for 'he': {'distribution': '1.000', 'strength': '1.000', 'middle': '0.500', 'vspan': '1.000', 'columns': '0.500', 'remote': '1.000', 'inward': '1.000'}
      Sample scores for 'ot': {'distribution': '1.000', 'strength': '0.500', 'middle': '0.000', 'vspan': '1.000', 'columns': '0.500', 'remote': '1.000', 'inward': '1.000'}
    Completed score calculation in 41.0s                                                  
    DEBUG STATISTICS:
      Total processed: 8,594,699
      Scoring failures: 0
      Validation failures: 0
      Records added: 8,594,699
      Valid sequences for analysis: 8,594,699
      Sequence scores data length: 8,594,699
    Stored sequence data under key: _sequence_scores_raw_with_middle (8594699 records)
    Calculating correlations for 7 criteria...
    Correlation analysis complete
  üîç Starting frequency adjustment for bigrams...
      Input: 8,594,699 sequences, 669 frequency entries
      Frequency data columns: ['letter_pair', 'count', 'normalized_frequency']
      Using 'normalized_frequency' column
      Built frequency dictionary: 669 entries
      Example frequencies: [('th', 1.0), ('he', 0.931042309115242), ('in', 0.82804339705559), ('er', 0.759711617990871), ('an', 0.747899268441765)]
      Frequency overlap: 8594699/8594699 (100.0%)
      Frequency range: 0.002254 to 1.000000 (mean: 0.524697)
      Time range: 50.0 to 2000.0ms (mean: 168.7 ¬± 139.2)
      Regression results:
        R¬≤ = 0.0321
        Slope = -91.0733 (p = 0.0000)
        Intercept = 136.7246
        ‚Üí Negative slope means higher frequency = faster typing
      Frequency control effects:
        Average |residual|: 77.20ms
        Maximum |residual|: 1860.45ms
        Sequences with frequency control: 99.9%
      üìä RANK ORDER ANALYSIS:
        Correlation between raw times and frequency residuals: 0.913670
        Sequences with rank changes: 8594685/8594699 (100.0%)
        Maximum rank position change: 7417635
  ‚úÖ Generated frequency-controlled residuals
  üí° INTERPRETATION: Residuals represent typing speed after controlling for frequency
      ‚Ä¢ Negative residuals = faster than expected given frequency
      ‚Ä¢ Positive residuals = slower than expected given frequency
  Freq Adjusted Analysis:
  Calculating Dvorak-7 scores for 8,594,699 sequences...
      Sample scores for 'th': {'distribution': '1.000', 'strength': '1.000', 'middle': '0.500', 'vspan': '1.000', 'columns': '0.000', 'remote': '1.000', 'inward': '1.000'}
      Sample scores for 'he': {'distribution': '1.000', 'strength': '1.000', 'middle': '0.500', 'vspan': '1.000', 'columns': '0.500', 'remote': '1.000', 'inward': '1.000'}
      Sample scores for 'ot': {'distribution': '1.000', 'strength': '0.500', 'middle': '0.000', 'vspan': '1.000', 'columns': '0.500', 'remote': '1.000', 'inward': '1.000'}
    Completed score calculation in 40.9s                                                  
    DEBUG STATISTICS:
      Total processed: 8,594,699
      Scoring failures: 0
      Validation failures: 0
      Records added: 8,594,699
      Valid sequences for analysis: 8,594,699
      Sequence scores data length: 8,594,699
    Stored sequence data under key: _sequence_scores_freq_adjusted_with_middle (8594699 records)
    Calculating correlations for 7 criteria...
    Correlation analysis complete
Bigram analysis completed in 5.2m

BIGRAM CORRELATION ANALYSIS: RAW vs FREQUENCY-ADJUSTED
========================================================================================================================
Note: Negative correlation = higher score ‚Üí faster typing (validates Dvorak)
      Positive correlation = higher score ‚Üí slower typing (contradicts Dvorak)
------------------------------------------------------------------------------------------------------------------------

Analyzing criterion combinations...

================================================================================
COMPREHENSIVE CRITERION COMBINATION ANALYSIS
================================================================================
Examining how combinations of criteria interact to predict typing speed
IMPORTANT: Using ONLY frequency-adjusted data (controls for English bigram frequency)
DEBUG: Looking for sequence data in results...
DEBUG: Available result keys:
  Found: _sequence_scores_freq_adjusted_no_middle (10800898 sequences)
  Found: _sequence_scores_freq_adjusted_with_middle (8594699 sequences)
  Found: _sequence_scores_raw_no_middle (10800898 sequences)
  Found: _sequence_scores_raw_with_middle (8594699 sequences)
‚úÖ Using 19,395,597 frequency-adjusted sequences
Sequence data found for combination analysis
------------------------------------------------------------
   Sequences: 19,395,597
   Expected criteria: ['distribution', 'strength', 'middle', 'vspan', 'columns', 'remote', 'inward']
   Found criteria: ['distribution', 'strength', 'middle', 'vspan', 'columns', 'remote', 'inward']
   Using criteria: ['distribution', 'strength', 'middle', 'vspan', 'columns', 'remote', 'inward']
   Using frequency-adjusted times for combination analysis

üìä 1-WAY COMBINATIONS:
   Testing ALL 7 combinations of 1 criteria...
   Top 5 combinations:
     1. vspan
        r = -0.1655***, p = 0.0000
     2. distribution
        r = -0.1621***, p = 0.0000
     3. remote
        r = -0.1404***, p = 0.0000
     4. inward
        r = -0.0851***, p = 0.0000
     5. strength
        r = 0.0441***, p = 0.0000

üìä 2-WAY COMBINATIONS:
   Testing ALL 21 combinations of 2 criteria...
   Top 5 combinations:
     1. vspan + remote
        r = -0.1889***, p = 0.0000
     2. distribution + vspan
        r = -0.1763***, p = 0.0000
     3. distribution + remote
        r = -0.1675***, p = 0.0000
     4. vspan + inward
        r = -0.1486***, p = 0.0000
     5. distribution + inward
        r = -0.1463***, p = 0.0000

üìä 3-WAY COMBINATIONS:
   Testing ALL 35 combinations of 3 criteria...
   Top 5 combinations:
     1. vspan + columns + remote
        r = -0.1819***, p = 0.0000
     2. distribution + vspan + remote
        r = -0.1815***, p = 0.0000
     3. distribution + vspan + columns
        r = -0.1746***, p = 0.0000
     4. distribution + columns + remote
        r = -0.1689***, p = 0.0000
     5. vspan + remote + inward
        r = -0.1643***, p = 0.0000

üìä 4-WAY COMBINATIONS:
   Testing ALL 35 combinations of 4 criteria...
   Top 5 combinations:
     1. distribution + vspan + columns + remote
        r = -0.1912***, p = 0.0000
     2. distribution + middle + vspan + remote
        r = -0.1733***, p = 0.0000
     3. vspan + columns + remote + inward
        r = -0.1674***, p = 0.0000
     4. middle + vspan + columns + remote
        r = -0.1650***, p = 0.0000
     5. distribution + vspan + remote + inward
        r = -0.1636***, p = 0.0000

üìä 5-WAY COMBINATIONS:
   Testing ALL 21 combinations of 5 criteria...
   Top 5 combinations:
     1. distribution + middle + vspan + columns + remote
        r = -0.1815***, p = 0.0000
     2. distribution + vspan + columns + remote + inward
        r = -0.1743***, p = 0.0000
     3. middle + vspan + columns + remote + inward
        r = -0.1617***, p = 0.0000
     4. distribution + strength + vspan + columns + remote
        r = -0.1606***, p = 0.0000
     5. distribution + middle + vspan + remote + inward
        r = -0.1589***, p = 0.0000

üìä 6-WAY COMBINATIONS:
   Testing ALL 7 combinations of 6 criteria...
   Top 5 combinations:
     1. distribution + middle + vspan + columns + remote + inward
        r = -0.1694***, p = 0.0000
     2. distribution + strength + middle + vspan + columns + remote
        r = -0.1653***, p = 0.0000
     3. distribution + strength + vspan + columns + remote + inward
        r = -0.1511***, p = 0.0000
     4. strength + middle + vspan + columns + remote + inward
        r = -0.1478***, p = 0.0000
     5. distribution + strength + middle + vspan + columns + inward
        r = -0.1422***, p = 0.0000

üìä 7-WAY COMBINATIONS:
   Testing ALL 1 combinations of 7 criteria...
   Top 1 combinations:
     1. distribution + strength + middle + vspan + columns + remote + inward
        r = -0.1564***, p = 0.0000

üèÜ BEST COMBINATION ACROSS ALL SIZES:
   üéØ STRONGEST PREDICTOR: distribution + vspan + columns + remote
   üìà Correlation: r = -0.1912
   üìä Effect size: small
   üé≠ Direction: supports Dvorak (faster)
   üî¢ Uses 4 criteria

================================================================================
ANALYSIS COMPLETE
================================================================================
Total runtime: 16.3m
Dvorak-7 Analysis Complete

