> poetry run python3 prep_scoring_tables.py --input-dir ../tables/ --verbose
Loading score files from: ../tables/
  ✓ 'NA' key pair preserved in keypair_comfort_scores.csv
Loaded 1024 rows from keypair_comfort_scores.csv
  Score range: -1.442261 - -0.061130
  ✓ Loaded comfort_score from keypair_comfort_scores.csv
  ✓ 'NA' key pair preserved in keypair_dvorak7_scores.csv
Loaded 1024 rows from keypair_dvorak7_scores.csv
  Score range: 0.500000 - 7.000000
  ✓ Loaded dvorak7_score from keypair_dvorak7_scores.csv
  ✓ 'NA' key pair preserved in keypair_engram8_scores.csv
Loaded 1024 rows from keypair_engram8_scores.csv
  Score range: 0.500000 - 7.000000
  ✓ Loaded engram8_score from keypair_engram8_scores.csv
  ⚠ Missing keypair_engram2_scores.csv, skipping engram2_score
  ✓ 'NA' key pair preserved in keypair_engram8_distributed_scores.csv
Loaded 1024 rows from keypair_engram8_distributed_scores.csv
  Score range: 0.000000 - 1.000000
  ✓ Loaded engram8_distributed from keypair_engram8_distributed_scores.csv
  ⚠ Missing keypair_engram8_strength_scores.csv, skipping engram8_strength
  ✓ 'NA' key pair preserved in keypair_engram8_primary_scores.csv
Loaded 1024 rows from keypair_engram8_primary_scores.csv
  Score range: 0.000000 - 1.000000
  ✓ Loaded engram8_primary from keypair_engram8_primary_scores.csv
  ✓ 'NA' key pair preserved in keypair_engram8_secondary_scores.csv
Loaded 1024 rows from keypair_engram8_secondary_scores.csv
  Score range: 0.000000 - 1.000000
  ✓ Loaded engram8_secondary from keypair_engram8_secondary_scores.csv
  ✓ 'NA' key pair preserved in keypair_engram8_lateral_scores.csv
Loaded 1024 rows from keypair_engram8_lateral_scores.csv
  Score range: 0.000000 - 0.000000
  ✓ Loaded engram8_lateral from keypair_engram8_lateral_scores.csv
  ✓ 'NA' key pair preserved in keypair_engram8_direction_scores.csv
Loaded 1024 rows from keypair_engram8_direction_scores.csv
  Score range: 0.000000 - 1.000000
  ✓ Loaded engram8_direction from keypair_engram8_direction_scores.csv
  ✓ 'NA' key pair preserved in keypair_engram8_vertical_scores.csv
Loaded 1024 rows from keypair_engram8_vertical_scores.csv
  Score range: 0.000000 - 1.000000
  ✓ Loaded engram8_vertical from keypair_engram8_vertical_scores.csv
  ✓ 'NA' key pair preserved in keypair_engram8_horizontal_scores.csv
Loaded 1024 rows from keypair_engram8_horizontal_scores.csv
  Score range: 0.000000 - 1.000000
  ✓ Loaded engram8_horizontal from keypair_engram8_horizontal_scores.csv
  ✓ 'NA' key pair preserved in keypair_dvorak7_repetition_scores.csv
Loaded 1024 rows from keypair_dvorak7_repetition_scores.csv
  Score range: 0.000000 - 1.000000
  ✓ Loaded dvorak7_repetition from keypair_dvorak7_repetition_scores.csv
  ✓ 'NA' key pair preserved in keypair_dvorak7_movement_scores.csv
Loaded 1024 rows from keypair_dvorak7_movement_scores.csv
  Score range: 0.000000 - 1.000000
  ✓ Loaded dvorak7_movement from keypair_dvorak7_movement_scores.csv
  ✓ 'NA' key pair preserved in keypair_dvorak7_vertical_scores.csv
Loaded 1024 rows from keypair_dvorak7_vertical_scores.csv
  Score range: 0.000000 - 1.000000
  ✓ Loaded dvorak7_vertical from keypair_dvorak7_vertical_scores.csv
  ✓ 'NA' key pair preserved in keypair_dvorak7_horizontal_scores.csv
Loaded 1024 rows from keypair_dvorak7_horizontal_scores.csv
  Score range: 0.000000 - 1.000000
  ✓ Loaded dvorak7_horizontal from keypair_dvorak7_horizontal_scores.csv
  ✓ 'NA' key pair preserved in keypair_dvorak7_adjacent_scores.csv
Loaded 1024 rows from keypair_dvorak7_adjacent_scores.csv
  Score range: 0.000000 - 1.000000
  ✓ Loaded dvorak7_adjacent from keypair_dvorak7_adjacent_scores.csv
  ✓ 'NA' key pair preserved in keypair_dvorak7_weak_scores.csv
Loaded 1024 rows from keypair_dvorak7_weak_scores.csv
  Score range: 0.000000 - 1.000000
  ✓ Loaded dvorak7_weak from keypair_dvorak7_weak_scores.csv
  ✓ 'NA' key pair preserved in keypair_dvorak7_outward_scores.csv
Loaded 1024 rows from keypair_dvorak7_outward_scores.csv
  Score range: 0.000000 - 1.000000
  ✓ Loaded dvorak7_outward from keypair_dvorak7_outward_scores.csv
  ⚠ Missing 'distance_score' column in keypair_distance_scores.csv
    Available columns: ['key_pair', 'distance_setup', 'distance_interval', 'distance_return', 'distance_total']
  ⚠ Skipping distance_score from keypair_distance_scores.csv (column not found)
  ⚠ Missing 'time_score' column in keypair_time_scores.csv
    Available columns: ['key_pair', 'time_setup', 'time_interval', 'time_return', 'time_total', 'setup_source', 'interval_source', 'return_source']
  ⚠ Skipping time_score from keypair_time_scores.csv (column not found)
Loaded 1024 rows from keypair_distance_scores.csv
  distance_setup range: 0.000000 - 34.669872
  distance_interval range: 0.000000 - 50.990195
  distance_return range: 0.000000 - 65.280327
  distance_total range: 0.000000 - 130.560655
  ✓ Loaded detailed distance scores from keypair_distance_scores.csv
    Components: distance_setup, distance_interval, distance_return, distance_total
Loaded 1024 rows from keypair_time_scores.csv
  time_setup range: 200.000000 - 400.000000
  time_interval range: 102.000000 - 448.000000
  time_return range: 200.000000 - 400.000000
  time_total range: 571.607151 - 1248.075636
  ✓ Loaded detailed time scores from keypair_time_scores.csv
    Components: time_setup, time_interval, time_return, time_total

Unified dataframe has 1024 rows
Score columns: ['distance_setup', 'distance_interval', 'distance_return', 'distance_total', 'time_setup', 'time_interval', 'time_return', 'time_total', 'comfort_score', 'dvorak7_score', 'engram8_score', 'engram8_distributed', 'engram8_primary', 'engram8_secondary', 'engram8_lateral', 'engram8_direction', 'engram8_vertical', 'engram8_horizontal', 'dvorak7_repetition', 'dvorak7_movement', 'dvorak7_vertical', 'dvorak7_horizontal', 'dvorak7_adjacent', 'dvorak7_weak', 'dvorak7_outward']

Applying universal normalization to score columns:
  distance_setup: Universal range [0, 35], 0 values clipped
    Original range: [0.000, 34.670]
    Normalized range: [0.000, 0.991]
    Added distance_setup_normalized (range: 0.000000 - 0.990568)
  distance_interval: Universal range [0, 55], 0 values clipped
    Original range: [0.000, 50.990]
    Normalized range: [0.000, 0.927]
    Added distance_interval_normalized (range: 0.000000 - 0.927094)
  distance_return: Universal range [0, 70], 0 values clipped
    Original range: [0.000, 65.280]
    Normalized range: [0.000, 0.933]
    Added distance_return_normalized (range: 0.000000 - 0.932576)
  distance_total: Universal range [0, 135], 0 values clipped
    Original range: [0.000, 130.561]
    Normalized range: [0.000, 0.967]
    Added distance_total_normalized (range: 0.000000 - 0.967116)
  time_setup: Universal range [200, 400], 0 values clipped
    Original range: [200.000, 400.000]
    Normalized range: [0.000, 1.000]
    Added time_setup_normalized (range: 0.000000 - 1.000000)
  time_interval: Universal range [100, 450], 0 values clipped
    Original range: [102.000, 448.000]
    Normalized range: [0.006, 0.994]
    Added time_interval_normalized (range: 0.005714 - 0.994286)
  time_return: Universal range [200, 400], 0 values clipped
    Original range: [200.000, 400.000]
    Normalized range: [0.000, 1.000]
    Added time_return_normalized (range: 0.000000 - 1.000000)
  time_total: Universal range [570, 1250], 0 values clipped
    Original range: [571.607, 1248.076]
    Normalized range: [0.002, 0.997]
    Added time_total_normalized (range: 0.002363 - 0.997170)
  comfort_score: Universal range [-1.5, 0.0], 0 values clipped
    Original range: [-1.442, -0.061]
    Normalized range: [0.038, 0.959]
    Added comfort_score_normalized (range: 0.038493 - 0.959247)
  dvorak7_score: Universal range [0, 1], 1001 values clipped
    Original range: [0.500, 7.000]
    Normalized range: [0.500, 1.000]
    Added dvorak7_score_normalized (range: 0.500000 - 1.000000)
  engram8_score: Universal range [0, 1], 996 values clipped
    Original range: [0.500, 7.000]
    Normalized range: [0.500, 1.000]
    Added engram8_score_normalized (range: 0.500000 - 1.000000)
  engram8_distributed: Universal range [0, 1], 0 values clipped
    Original range: [0.000, 1.000]
    Normalized range: [0.000, 1.000]
    Added engram8_distributed_normalized (range: 0.000000 - 1.000000)
  engram8_primary: Universal range [0, 1], 0 values clipped
    Original range: [0.000, 1.000]
    Normalized range: [0.000, 1.000]
    Added engram8_primary_normalized (range: 0.000000 - 1.000000)
  engram8_secondary: Universal range [0, 1], 0 values clipped
    Original range: [0.000, 1.000]
    Normalized range: [0.000, 1.000]
    Added engram8_secondary_normalized (range: 0.000000 - 1.000000)
  engram8_lateral: Universal range [0, 1], 0 values clipped
    Original range: [0.000, 0.000]
    Normalized range: [0.000, 0.000]
    Added engram8_lateral_normalized (range: 0.000000 - 0.000000)
  engram8_direction: Universal range [0, 1], 0 values clipped
    Original range: [0.000, 1.000]
    Normalized range: [0.000, 1.000]
    Added engram8_direction_normalized (range: 0.000000 - 1.000000)
  engram8_vertical: Universal range [0, 1], 0 values clipped
    Original range: [0.000, 1.000]
    Normalized range: [0.000, 1.000]
    Added engram8_vertical_normalized (range: 0.000000 - 1.000000)
  engram8_horizontal: Universal range [0, 1], 0 values clipped
    Original range: [0.000, 1.000]
    Normalized range: [0.000, 1.000]
    Added engram8_horizontal_normalized (range: 0.000000 - 1.000000)
  dvorak7_repetition: Universal range [0, 1], 0 values clipped
    Original range: [0.000, 1.000]
    Normalized range: [0.000, 1.000]
    Added dvorak7_repetition_normalized (range: 0.000000 - 1.000000)
  dvorak7_movement: Universal range [0, 1], 0 values clipped
    Original range: [0.000, 1.000]
    Normalized range: [0.000, 1.000]
    Added dvorak7_movement_normalized (range: 0.000000 - 1.000000)
  dvorak7_vertical: Universal range [0, 1], 0 values clipped
    Original range: [0.000, 1.000]
    Normalized range: [0.000, 1.000]
    Added dvorak7_vertical_normalized (range: 0.000000 - 1.000000)
  dvorak7_horizontal: Universal range [0, 1], 0 values clipped
    Original range: [0.000, 1.000]
    Normalized range: [0.000, 1.000]
    Added dvorak7_horizontal_normalized (range: 0.000000 - 1.000000)
  dvorak7_adjacent: Universal range [0, 1], 0 values clipped
    Original range: [0.000, 1.000]
    Normalized range: [0.000, 1.000]
    Added dvorak7_adjacent_normalized (range: 0.000000 - 1.000000)
  dvorak7_weak: Universal range [0, 1], 0 values clipped
    Original range: [0.000, 1.000]
    Normalized range: [0.000, 1.000]
    Added dvorak7_weak_normalized (range: 0.000000 - 1.000000)
  dvorak7_outward: Universal range [0, 1], 0 values clipped
    Original range: [0.000, 1.000]
    Normalized range: [0.000, 1.000]
    Added dvorak7_outward_normalized (range: 0.000000 - 1.000000)

🎯 Creating composite scores from detailed components...
  ✓ Engram-8: Composite from 15 components
  ✓ Dvorak-7: Composite from 15 components
  ✓ Time: Using time_total
  ✓ Distance: Using distance_total
  ✓ Comfort: Using comfort_score

Applying universal normalization to composite scores:
  engram8_score: Universal range [0, 1], 0 values clipped
    Original range: [0.067, 0.867]
    Normalized range: [0.067, 0.867]
    Added engram8_score_normalized (range: 0.066667 - 0.866667)
  dvorak7_score: Universal range [0, 1], 0 values clipped
    Original range: [0.100, 1.000]
    Normalized range: [0.100, 1.000]
    Added dvorak7_score_normalized (range: 0.100000 - 1.000000)
  time_score: Universal range [570, 1250], 0 values clipped
    Original range: [571.607, 1248.076]
    Normalized range: [0.002, 0.997]
    Added time_score_normalized (range: 0.002363 - 0.997170)
  distance_score: Universal range [0, 135], 0 values clipped
    Original range: [0.000, 130.561]
    Normalized range: [0.000, 0.967]
    Added distance_score_normalized (range: 0.000000 - 0.967116)
  comfort_score: Universal range [-1.5, 0.0], 0 values clipped
    Original range: [-1.442, -0.061]
    Normalized range: [0.038, 0.959]
    Added comfort_score_normalized (range: 0.038493 - 0.959247)

Saved detailed scoring table to: ../tables/keypair_scores_detailed.csv
  Table contains 1024 rows and 51 columns
  Detailed columns: ['key_pair', 'comfort_score', 'distance_interval', 'distance_return', 'distance_setup', 'distance_total', 'dvorak7_adjacent', 'dvorak7_horizontal', 'dvorak7_movement', 'dvorak7_outward', 'dvorak7_repetition', 'dvorak7_score', 'dvorak7_vertical', 'dvorak7_weak', 'engram8_direction', 'engram8_distributed', 'engram8_horizontal', 'engram8_lateral', 'engram8_primary', 'engram8_score', 'engram8_secondary', 'engram8_vertical', 'time_interval', 'time_return', 'time_setup', 'time_total', 'comfort_score_normalized', 'distance_interval_normalized', 'distance_return_normalized', 'distance_setup_normalized', 'distance_total_normalized', 'dvorak7_adjacent_normalized', 'dvorak7_horizontal_normalized', 'dvorak7_movement_normalized', 'dvorak7_outward_normalized', 'dvorak7_repetition_normalized', 'dvorak7_score_normalized', 'dvorak7_vertical_normalized', 'dvorak7_weak_normalized', 'engram8_direction_normalized', 'engram8_distributed_normalized', 'engram8_horizontal_normalized', 'engram8_lateral_normalized', 'engram8_primary_normalized', 'engram8_score_normalized', 'engram8_secondary_normalized', 'engram8_vertical_normalized', 'time_interval_normalized', 'time_return_normalized', 'time_setup_normalized', 'time_total_normalized']

Saved composite scoring table to: ../tables/keypair_scores_composite.csv
  Table contains 1024 rows and 11 columns
  Composite columns: ['key_pair', 'comfort_score', 'distance_score', 'dvorak7_score', 'engram8_score', 'time_score', 'comfort_score_normalized', 'distance_score_normalized', 'dvorak7_score_normalized', 'engram8_score_normalized', 'time_score_normalized']

Composite score statistics:
  engram8_score: 0.066667 - 0.866667 (mean: 0.571810)
  dvorak7_score: 0.100000 - 1.000000 (mean: 0.663932)
  time_score: 571.607151 - 1248.075636 (mean: 839.122335)
  distance_score: 0.000000 - 130.560655 (mean: 63.147447)
  comfort_score: -1.442261 - -0.061130 (mean: -0.801436)
  ✓ 'NA' key pair preserved in comfort scores
  comfort_score: Universal range [-1.5, 0.0], 0 values clipped
    Original range: [-1.442, -0.061]
    Normalized range: [0.038, 0.959]

Created key comfort scores table: ../tables/key_scores.csv
  Keys: 32 individual keys
  Score range: 0.038493 - 0.959247
  Mean score: 0.480644

Successfully created scoring tables:
  - Detailed scores: ../tables/keypair_scores_detailed.csv
  - Composite scores: ../tables/keypair_scores_composite.csv
  - Key scores: ../tables/key_scores.csv
